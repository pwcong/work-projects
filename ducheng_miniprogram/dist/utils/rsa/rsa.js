"use strict";function _interopRequireDefault(i){return i&&i.__esModule?i:{default:i}}function _interopRequireWildcard(i){if(i&&i.__esModule)return i;var t={};if(null!=i)for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function encryptedString(i,t,e,r){var n,o,a,d,g,c,u,s,h,b,l=new Array,S=t.length,f="";for(d="string"==typeof e?e==RSAAPP.NoPadding?1:e==RSAAPP.PKCS1Padding?2:0:0,g="string"==typeof r&&r==RSAAPP.RawEncoding?1:0,1==d?S>i.chunkSize&&(S=i.chunkSize):2==d&&S>i.chunkSize-11&&(S=i.chunkSize-11),n=0,o=2==d?S-1:i.chunkSize-1;n<S;)d?l[o]=t.charCodeAt(n):l[n]=t.charCodeAt(n),n++,o--;for(1==d&&(n=0),o=i.chunkSize-S%i.chunkSize;o>0;){if(2==d){for(c=Math.floor(256*Math.random());!c;)c=Math.floor(256*Math.random());l[n]=c}else l[n]=0;n++,o--}for(2==d&&(l[S]=0,l[i.chunkSize-2]=2,l[i.chunkSize-1]=0),u=l.length,n=0;n<u;n+=i.chunkSize){for(s=new bigint.BigInt,o=0,a=n;a<n+i.chunkSize;++o)s.digits[o]=l[a++],s.digits[o]+=l[a++]<<8;h=i.barrett.powMod(s,i.e),b=1==g?bigint.biToBytes(h):16==i.radix?bigint.biToHex(h):bigint.biToString(h,i.radix),f+=b}return f}function decryptedString(i,t){var e,r,n,o,a=t.split(" "),d="";for(r=0;r<a.length;++r)for(o=16==i.radix?bigint.biFromHex(a[r]):bigint.biFromString(a[r],i.radix),e=i.barrett.powMod(o,i.d),n=0;n<=bigint.biHighIndex(e);++n)d+=String.fromCharCode(255&e.digits[n],e.digits[n]>>8);return 0==d.charCodeAt(d.length-1)&&(d=d.substring(0,d.length-1)),d}Object.defineProperty(exports,"__esModule",{value:!0}),exports.RSAKeyPair=exports.RSAAPP=void 0,exports.encryptedString=encryptedString,exports.decryptedString=decryptedString;var _bigint=require("./bigint.js"),bigint=_interopRequireWildcard(_bigint),_barrett=require("./barrett.js"),_barrett2=_interopRequireDefault(_barrett),RSAAPP=exports.RSAAPP={NoPadding:"NoPadding",PKCS1Padding:"PKCS1Padding",RawEncoding:"RawEncoding",NumericEncoding:"NumericEncoding"},RSAKeyPair=exports.RSAKeyPair=function i(t,e,r,n){_classCallCheck(this,i),this.e=bigint.biFromHex(t),this.d=bigint.biFromHex(e),this.m=bigint.biFromHex(r),this.chunkSize="number"!=typeof n?2*bigint.biHighIndex(this.m):n/8,this.radix=16,this.barrett=new _barrett2.default(this.m)};