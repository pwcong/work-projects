{"version":3,"sources":["share.js"],"names":["RankingItem","ranking","avatar","name","sex","score","this","media","loadRecordsRank","pageNo","onSuccess","onFail","onComplete","API","getAllRecordsRank","PAGE_SIZE","data","code","result","list","forEach","item","index","rankingItem","pageOffset_1","avater","nickname","gender","record","$","before","makeHTML","length","err","loadDaysRecords","getAllDaysRank","pageOffset_2","insistDay","prototype","rankingItemDIV","document","createElement","className","innerHTML","pageNo_1","hasMore_1","pageNo_2","hasMore_2","ready","attr","utils","getUrlParam","show","html","addClass","console","log","totalPage","click","e","removeClass"],"mappings":"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","file":"share.js","sourcesContent":["function RankingItem(ranking, avatar, name, sex, score) {\r\n    this.ranking = ranking;\r\n    this.media = ranking == 1 ? 'icon-gold' : (ranking == 2 ? 'icon-silver' : (ranking == 3 ? 'icon-copper' : 'icon-medal'));\r\n    this.avatar = avatar || 'imgs/avatar.png';\r\n    this.name = name || '-';\r\n    this.sex = sex == 2 ? 'icon-female' : (sex == 1 ? 'icon-male' : '');\r\n    this.score = score || 0;\r\n}\r\n\r\nRankingItem.prototype.makeHTML = function () {\r\n\r\n    var rankingItemDIV = document.createElement('div');\r\n    rankingItemDIV.className = 'item';\r\n\r\n    rankingItemDIV.innerHTML = '\\\r\n        <div class=\"left\">\\\r\n            <span class=\"medal icon ' + this.media + '\">' + (this.ranking > 3 ? this.ranking : '') + '</span>\\\r\n            <img class=\"avatar\" src=\"' + this.avatar + '\" alt=\"avatar\">\\\r\n            <span class=\"name\">' + this.name + '</span>\\\r\n            <span class=\"sex icon ' + this.sex + '\"></span>\\\r\n        </div>\\\r\n        <div class=\"right\">' + this.score + '</div>';\r\n\r\n    return rankingItemDIV;\r\n\r\n}\r\n\r\nvar PAGE_SIZE = 10;\r\nvar pageNo_1 = 1;\r\nvar pageOffset_1 = 0;\r\nvar hasMore_1 = false;\r\n\r\nvar pageNo_2 = 1;\r\nvar pageOffset_2 = 0;\r\nvar hasMore_2 = false;\r\n\r\nfunction loadRecordsRank(pageNo, onSuccess, onFail, onComplete) {\r\n\r\n    API.getAllRecordsRank(\r\n        pageNo,\r\n        PAGE_SIZE,\r\n        function (data) {\r\n\r\n            onSuccess && onSuccess(data);\r\n\r\n            if (data.code != 'SUCCESS' || !data.result || !data.result.list) {\r\n                return;\r\n            }\r\n\r\n            data.result.list.forEach(function (item, index) {\r\n\r\n                var rankingItem = new RankingItem(index + pageOffset_1 + 1, item.avater, item.nickname, item.gender, item.record);\r\n\r\n                $('#timeRanking .tips').before(rankingItem.makeHTML());\r\n\r\n            });\r\n\r\n            pageOffset_1 += data.result.list.length;\r\n\r\n\r\n        },\r\n        function (err) {\r\n            onFail && onFail(err);\r\n        },\r\n        function (data) {\r\n            onComplete && onComplete();\r\n        }\r\n\r\n    );\r\n\r\n}\r\n\r\nfunction loadDaysRecords(pageNo, onSuccess, onFail, onComplete) {\r\n\r\n    API.getAllDaysRank(\r\n        pageNo,\r\n        PAGE_SIZE,\r\n        function (data) {\r\n\r\n            onSuccess && onSuccess(data);\r\n\r\n            if (data.code != 'SUCCESS' || !data.result || !data.result.list) {\r\n                return;\r\n            }\r\n\r\n            data.result.list.forEach(function (item, index) {\r\n\r\n                var rankingItem = new RankingItem(index + pageOffset_2 + 1, item.avater, item.nickname, item.gender, item.insistDay);\r\n\r\n                $('#dayRanking .tips').before(rankingItem.makeHTML());\r\n\r\n            });\r\n\r\n            pageOffset_2 += data.result.list.length;\r\n\r\n        },\r\n        function (err) {\r\n            onFail && onFail(err);\r\n        },\r\n        function (data) {\r\n            onComplete && onComplete();\r\n        }\r\n\r\n    );\r\n\r\n}\r\n\r\n// 初始化信息\r\n$(document).ready(function () {\r\n\r\n\r\n    $('#avatar').attr('src', utils.getUrlParam('a') || 'imgs/avatar.png');\r\n    $('#avatar').show();\r\n    $('#name').html(utils.getUrlParam('n') || '-');\r\n\r\n    switch (utils.getUrlParam('s')) {\r\n        case '1':\r\n            $('#sex').addClass('icon-male');\r\n            break;\r\n        case '2':\r\n\r\n            $('#sex').addClass('icon-female');\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n\r\n    $('#practiceTime').html(utils.getUrlParam('ar') || 0);\r\n    $('#duration').html(utils.getUrlParam('i') || 0);\r\n\r\n    loadRecordsRank(pageNo_1,\r\n        function (data) {\r\n\r\n            if (!data.code == 'SUCCESS' || !data.result) {\r\n                return;\r\n            }\r\n\r\n            console.log(data);\r\n\r\n            if (data.result.totalPage > pageNo_1) {\r\n\r\n                pageNo_1++;\r\n                hasMore_1 = true;\r\n\r\n                $('#timeRanking .tips').html('加载更多');\r\n\r\n            } else {\r\n                hasMore_1 = false;\r\n                $('#timeRanking .tips').html('没有了~');\r\n            }\r\n\r\n        },\r\n        function (err) {\r\n\r\n        },\r\n        function () {\r\n\r\n        }\r\n    );\r\n\r\n    loadDaysRecords(pageNo_2,\r\n        function (data) {\r\n            if (!data.code == 'SUCCESS' || !data.result) {\r\n                return;\r\n            }\r\n\r\n            if (data.result.totalPage > pageNo_2) {\r\n\r\n                pageNo_2++;\r\n                hasMore_2 = true;\r\n\r\n                $('#dayRanking .tips').html('加载更多');\r\n\r\n            } else {\r\n                hasMore_2 = false;\r\n                $('#dayRanking .tips').html('没有了~');\r\n            }\r\n        },\r\n        function (err) {\r\n\r\n        },\r\n        function () {\r\n\r\n        }\r\n    );\r\n\r\n    $('#timeRanking .tips').click(function (e) {\r\n\r\n        if (hasMore_1) {\r\n\r\n            $('#timeRanking .tips').html('加载中');\r\n\r\n            loadRecordsRank(pageNo_1,\r\n                function (data) {\r\n\r\n                    if (!data.code == 'SUCCESS' || !data.result) {\r\n                        return;\r\n                    }\r\n\r\n\r\n                    if (data.result.totalPage > pageNo_1) {\r\n\r\n                        pageNo_1++;\r\n                        hasMore_1 = true;\r\n\r\n                        $('#timeRanking .tips').html('加载更多');\r\n\r\n                    } else {\r\n                        hasMore_1 = false;\r\n                        $('#timeRanking .tips').html('没有了~');\r\n                    }\r\n\r\n                },\r\n                function (err) {\r\n\r\n                },\r\n                function () {\r\n\r\n                }\r\n            );\r\n        }\r\n    });\r\n\r\n    $('#dayRanking .tips').click(function (e) {\r\n\r\n        if (hasMore_2) {\r\n\r\n            $('#dayRanking .tips').html('加载中');\r\n\r\n            loadDaysRecords(pageNo_2,\r\n                function (data) {\r\n                    if (!data.code == 'SUCCESS' || !data.result) {\r\n                        return;\r\n                    }\r\n\r\n                    if (data.result.totalPage > pageNo_2) {\r\n\r\n                        pageNo_2++;\r\n                        hasMore_2 = true;\r\n\r\n                        $('#dayRanking .tips').html('加载更多');\r\n\r\n                    } else {\r\n                        hasMore_2 = false;\r\n                        $('#dayRanking .tips').html('没有了~');\r\n                    }\r\n                },\r\n                function (err) {\r\n\r\n                },\r\n                function () {\r\n\r\n                }\r\n            );\r\n\r\n\r\n\r\n        }\r\n\r\n\r\n    });\r\n\r\n\r\n    // API.getAllRecordsRank(\r\n    //     function (data) {\r\n\r\n    //         if (data.code != 'SUCCESS' || !data.result || !data.result.list) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         data.result.list.forEach(function (item, index) {\r\n\r\n    //             var rankingItem = new RankingItem(index + 1, item.avater, item.nickname, item.gender, item.record);\r\n\r\n    //             $('#timeRanking .tips').before(rankingItem.makeHTML());\r\n    //         });\r\n\r\n\r\n    //     },\r\n    //     function (err) {\r\n\r\n    //     },\r\n    //     function (data) {\r\n\r\n    //     }\r\n\r\n    // );\r\n\r\n    // API.getAllDaysRank(\r\n    //     function (data) {\r\n\r\n    //         if (data.code != 'SUCCESS' || !data.result || !data.result.list) {\r\n    //             return;\r\n    //         }\r\n\r\n    //         data.result.list.forEach(function (item, index) {\r\n\r\n    //             var rankingItem = new RankingItem(index + 1, item.avater, item.nickname, item.gender, item.insistDay);\r\n\r\n    //             $('#dayRanking .tips').before(rankingItem.makeHTML());\r\n    //         });\r\n\r\n\r\n    //     },\r\n    //     function (err) {\r\n\r\n    //     },\r\n    //     function (data) {\r\n\r\n    //     }\r\n\r\n    // );\r\n\r\n\r\n\r\n\r\n});\r\n\r\n// 初始化排行榜navbar\r\n$(document).ready(function () {\r\n\r\n\r\n    $('#showTimeRanking').click(function () {\r\n\r\n        $(this).addClass('active');\r\n        $('#showDayRanking').removeClass('active');\r\n\r\n        $('#timeRanking').removeClass('hide');\r\n        $('#dayRanking').addClass('hide');\r\n\r\n\r\n    });\r\n\r\n    $('#showDayRanking').click(function () {\r\n\r\n        $(this).addClass('active');\r\n        $('#showTimeRanking').removeClass('active');\r\n\r\n        $('#dayRanking').removeClass('hide');\r\n        $('#timeRanking').addClass('hide');\r\n    });\r\n\r\n});"]}