{"version":3,"sources":["info.js"],"names":["$","document","ready","window","localStorage","sessionId","API","getClass","data","code","result","forEach","item","index","selectOption","createElement","setAttribute","id","innerHTML","name","append","getUserInfo","attr","avater","removeClass","val","nickname","age","classId","removeAttr","gender","err","click","ctx","this","nickName","sex","selectClass","html","modifyUserInfo","weui","toast","alert","className","history","back"],"mappings":"AACAA,EAAEC,UAAUC,MAAM,WAETC,OAAOC,aAAaC,WAIzBC,IAAIC,SACAJ,OAAOC,aAAaC,UACpB,SAAUG,GAEW,WAAbA,EAAKC,MAAsBD,EAAKE,SAIpCF,EAAKE,OAAOC,QAAQ,SAAUC,EAAMC,GAEhC,IAAIC,EAAeb,SAASc,cAAc,UAE1CD,EAAaE,aAAa,QAASJ,EAAKK,IACxCH,EAAaI,UAAYN,EAAKO,KAE9BnB,EAAE,gBAAgBoB,OAAON,KAI7BR,IAAIe,YACAlB,OAAOC,aAAaC,UACpB,SAAUG,GAEW,WAAbA,EAAKC,MAAsBD,EAAKE,SAIpCV,EAAE,WAAWsB,KAAK,MAAOd,EAAKE,OAAOa,QAAU,mBAC/CvB,EAAE,WAAWwB,YAAY,QACzBxB,EAAE,kBAAkByB,IAAIjB,EAAKE,OAAOgB,UACpC1B,EAAE,aAAayB,IAAIjB,EAAKE,OAAOiB,KAC/B3B,EAAE,gBAAgByB,IAAIjB,EAAKE,OAAOkB,SAAW,IAE7C5B,EAAE,oBAAoB6B,WAAW,WACjC7B,EAAE,4BAA8BQ,EAAKE,OAAOoB,OAAS,KAAKR,KAAK,UAAW,aAG9E,SAAUS,KAGV,SAAUvB,QAOlB,SAAUuB,KAGV,SAAUvB,QAoElBR,EAAEC,UAAUC,MAAM,WAEdF,EAAE,cAAcgC,MAAM,WAElB,IAAIC,EAAMjC,EAAEkC,MAERC,EAAWnC,EAAE,kBAAkByB,MAC/BW,EAAMpC,EAAE,8BAA8ByB,MACtCE,EAAM3B,EAAE,aAAayB,MACrBY,EAAcrC,EAAE,gBAAgByB,MAE/BU,EAOAC,EAOAT,EAOAU,EAQAlC,OAAOC,aAAaC,YAuCzB4B,EAAIX,KAAK,WAAY,YACrBW,EAAIK,KAAK,OAEThC,IAAIiC,eACApC,OAAOC,aAAaC,UACpB8B,EACAC,EACAT,EACAU,EACA,SAAU7B,GAEW,WAAbA,EAAKC,MAIT+B,KAAKC,MAAM,OAAQ,OAGvB,SAAUV,GACNS,KAAKC,MAAM,OAAQ,OAEvB,SAAUjC,GACNyB,EAAIJ,WAAW,WAAY,YAC3BI,EAAIK,KAAK,SArEbE,KAAKE,MAAM,SACPC,UAAW,WARfH,KAAKE,MAAM,SACPC,UAAW,WARfH,KAAKE,MAAM,SACPC,UAAW,WARfH,KAAKE,MAAM,SACPC,UAAW,aAiGvB3C,EAAE,YAAYgC,MAAM,WAChB7B,OAAOyC,QAAQC","file":"info.js","sourcesContent":["// 初始化信息\r\n$(document).ready(function () {\r\n\r\n    if (!window.localStorage.sessionId) {\r\n        return;\r\n    }\r\n\r\n    API.getClass(\r\n        window.localStorage.sessionId,\r\n        function (data) {\r\n\r\n            if (data.code != 'SUCCESS' || !data.result) {\r\n                return;\r\n            }\r\n\r\n            data.result.forEach(function (item, index) {\r\n\r\n                var selectOption = document.createElement('option');\r\n\r\n                selectOption.setAttribute('value', item.id);\r\n                selectOption.innerHTML = item.name;\r\n\r\n                $('#selectClass').append(selectOption);\r\n\r\n            });\r\n\r\n            API.getUserInfo(\r\n                window.localStorage.sessionId,\r\n                function (data) {\r\n\r\n                    if (data.code != 'SUCCESS' || !data.result) {\r\n                        return;\r\n                    }\r\n\r\n                    $('#avatar').attr('src', data.result.avater || 'imgs/avatar.png');\r\n                    $('#avatar').removeClass('hide');\r\n                    $('#inputNickname').val(data.result.nickname);\r\n                    $('#inputAge').val(data.result.age);\r\n                    $('#selectClass').val(data.result.classId || '');\r\n\r\n                    $('input[name=\"sex\"').removeAttr('checked');\r\n                    $('input[name=\"sex\"][value=\"' + data.result.gender + '\"').attr('checked', 'checked');\r\n\r\n                },\r\n                function (err) {\r\n\r\n                },\r\n                function (data) {\r\n\r\n                }\r\n            );\r\n\r\n\r\n        },\r\n        function (err) {\r\n\r\n        },\r\n        function (data) {\r\n\r\n\r\n        }\r\n\r\n\r\n    );\r\n\r\n\r\n});\r\n\r\n// 校验计时器状态\r\n// $(document).ready(function () {\r\n\r\n//     if (window.localStorage.sessionId && window.localStorage.timerFlag == 'true') {\r\n\r\n//         var hours = parseInt(window.localStorage.hours || 0);\r\n//         var minutes = parseInt(window.localStorage.minutes || 0);\r\n//         var seconds = parseInt(window.localStorage.seconds || 0);\r\n\r\n//         setInterval(function () {\r\n\r\n//             seconds++;\r\n\r\n//             if (seconds >= 60) {\r\n//                 seconds = 0;\r\n//                 minutes++;\r\n//             }\r\n\r\n//             if (minutes >= 60) {\r\n//                 minutes = 0;\r\n//                 hours++;\r\n//             }\r\n\r\n//             if (hours >= 24) {\r\n//                 hours = 0;\r\n//             }\r\n\r\n//             window.localStorage.hours = hours;\r\n//             window.localStorage.minutes = minutes;\r\n//             window.localStorage.seconds = seconds;\r\n\r\n//         }, 1000);\r\n\r\n//     }\r\n\r\n\r\n// });\r\n\r\n\r\n// 修改头像\r\n// $(document).ready(function () {\r\n\r\n//     $('#inputAvatar').change(function (e) {\r\n\r\n//         if ($(this).prop('files').length < 1) {\r\n//             return;\r\n//         }\r\n\r\n//         $('#avatar').attr('src', window.URL.createObjectURL($(this).prop('files')[0]));\r\n\r\n//         // console.log($(this).prop('files'));\r\n\r\n//     });\r\n\r\n// });\r\n\r\n// 提交表单\r\n$(document).ready(function () {\r\n\r\n    $('#btnSubmit').click(function () {\r\n\r\n        var ctx = $(this);\r\n\r\n        var nickName = $('#inputNickname').val();\r\n        var sex = $('input[name|=\"sex\"]:checked').val();\r\n        var age = $('#inputAge').val();\r\n        var selectClass = $('#selectClass').val();\r\n\r\n        if (!nickName) {\r\n            weui.alert('请输入昵称', {\r\n                className: 'dialog'\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!sex) {\r\n            weui.alert('请选择性别', {\r\n                className: 'dialog'\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!age) {\r\n            weui.alert('请输入年龄', {\r\n                className: 'dialog'\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!selectClass) {\r\n            weui.alert('请选择班级', {\r\n                className: 'dialog'\r\n            });\r\n            return;\r\n        }\r\n\r\n\r\n        if (!window.localStorage.sessionId) {\r\n            return;\r\n        }\r\n\r\n        // var data = new FormData(); \r\n\r\n        // data.append('nickname', $('#inputNickname').val());\r\n\r\n        // data.append('sex', $('input[name|=\"sex\"]:checked').val());\r\n\r\n        // var files = $('#inputAvatar').prop('files');\r\n\r\n        // if (files.length > 0) {\r\n        //     var avatar = $('#inputAvatar').prop('files');\r\n        //     data.append('avatar', files[0]);  \r\n        // }\r\n\r\n        // var loading = weui.loading('提交中', {\r\n        //     className: 'loading'\r\n        // });\r\n\r\n        // $.ajax({  \r\n        //     url: '#',\r\n        //     type: 'POST',\r\n        //     data: data,\r\n        //     cache: false,\r\n        //     processData: false,\r\n        //     contentType: false,\r\n        //     success: function (data) {\r\n\r\n        //     },\r\n        //     error: function (e) {\r\n\r\n        //     },\r\n        //     complete: function (data) {\r\n        //         loading.hide();\r\n        //     }\r\n        // });\r\n\r\n        ctx.attr('disabled', 'disabled');\r\n        ctx.html('提交中');\r\n\r\n        API.modifyUserInfo(\r\n            window.localStorage.sessionId,\r\n            nickName,\r\n            sex,\r\n            age,\r\n            selectClass,\r\n            function (data) {\r\n\r\n                if (data.code != 'SUCCESS') {\r\n                    return;\r\n                }\r\n\r\n                weui.toast('修改成功', 1500);\r\n\r\n            },\r\n            function (err) {\r\n                weui.toast('修改失败', 1500);\r\n            },\r\n            function (data) {\r\n                ctx.removeAttr('disabled', 'disabled');\r\n                ctx.html('确定');\r\n            }\r\n\r\n        );\r\n\r\n    });\r\n\r\n\r\n    $('#btnBack').click(function () {\r\n        window.history.back();\r\n    });\r\n\r\n});"]}