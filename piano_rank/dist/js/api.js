!function(){function e(e,o,n,s){var d=weui.loading("登陆中",{className:"loading"});$.ajax({url:r.auth.url(e),method:r.auth.method,success:function(e){o&&o(),window.location.href=e,window.SESSION_CHECKED=!0,weui.loading("正在进入登陆页面",{className:"loading"})},error:function(e){n&&n(),weui.dialog("登陆失败",{className:"dialog"})},complete:function(e){s&&s(),d.hide()}})}function o(o){switch(o){case"SESSIONID_VALIDATE_ERROR":window.SESSION_CHECKED=!1,e(window.location.href)}}var n="http://www.ppfix.cn/piano_rank",r={auth:{url:function(e){return n+"/api/wx/authUrl?redirectUri="+e},method:"GET"},sign:{url:function(){return n+"/api/wx/jsapiSign?url="+window.location.href},method:"GET"},userInfo:{url:function(){return n+"/api/user/info"},method:"GET",headers:function(e){return{sessionId:e}}},modifyUserInfo:{url:function(e,o,r,s){return e=e||"",o=o||"",r=r||0,s=s||"",n+"/api/user/update?nickname="+e+"&gender="+o+"&age="+r+"&classId="+s},method:"GET",headers:function(e){return{sessionId:e}}},monthRecords:{url:function(e,o){return e=e||"",o=o||"",n+"/api/user/record/month?year="+e+"&month="+o},method:"GET",headers:function(e){return{sessionId:e}}},uploadRecord:{url:function(e,o,r){return e=e||0,o=o||"",r=r||"",n+"/api/user/record/upload?record="+e},method:"GET",headers:function(e){return{sessionId:e}}},dayRecords:{url:function(){return n+"/api/user/record/day"},method:"GET",headers:function(e){return{sessionId:e}}},allRecords:{url:function(e){return e=e||"",n+"/api/user/record/all?year="+e},method:"GET",headers:function(e){return{sessionId:e}}},allRecordsRank:{url:function(e,o){return e=e||1,o=o||100,n+"/api/rank/orderByRecord?pageNo="+e+"&pageSize="+o},method:"GET",headers:function(e){return{sessionId:e}}},allDaysRank:{url:function(e,o){return e=e||1,o=o||100,n+"/api/rank/orderByDay?pageNo="+e+"&pageSize="+o},method:"GET",headers:function(e){return{sessionId:e}}},getClass:{url:function(e,o){return e=e||1,o=o||100,n+"/api/user/getClass?pageNo="+e+"&pageSize="+o},method:"GET",headers:function(e){return{sessionId:e}}}};window.API||(window.API={}),window.API.getSessionId=e,window.API.getUserInfo=function(e,n,s,d){$.ajax({url:r.userInfo.url(),method:r.userInfo.method,headers:r.userInfo.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),s&&s(e.message),o(e.code)):n&&n(e)},error:function(e){s&&s(e)},complete:function(e){d&&d()}})},window.API.uploadRecord=function(e,n,s,d,t,c,a){$.ajax({url:r.uploadRecord.url(n,s,d),method:r.uploadRecord.method,headers:r.uploadRecord.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),c&&c(e.message),o(e.code)):t&&t(e)},error:function(e){c&&c(e)},complete:function(e){a&&a()}})},window.API.modifyUserInfo=function(e,n,s,d,t,c,a,u){$.ajax({url:r.modifyUserInfo.url(n,s,d,t),method:r.modifyUserInfo.method,headers:r.modifyUserInfo.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),a&&a(e.message),o(e.code)):c&&c(e)},error:function(e){a&&a(e)},complete:function(e){u&&u()}})},window.API.getAllRecords=function(e,n,s,d,t){$.ajax({url:r.allRecords.url(n),method:r.allRecords.method,headers:r.allRecords.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),d&&d(e.message),o(e.code)):s&&s(e)},error:function(e){d&&d(e)},complete:function(e){t&&t()}})},window.API.getDayRecords=function(e,n,s,d){$.ajax({url:r.dayRecords.url(),method:r.dayRecords.method,headers:r.dayRecords.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),s&&s(e.message),o(e.code)):n&&n(e)},error:function(e){s&&s(e)},complete:function(e){d&&d()}})},window.API.getMonthRecords=function(e,n,s,d,t,c){$.ajax({url:r.monthRecords.url(n,s),method:r.monthRecords.method,headers:r.monthRecords.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),t&&t(e.message),o(e.code)):d&&d(e)},error:function(e){t&&t(e)},complete:function(e){c&&c()}})},window.API.getAllDaysRank=function(e,n,s,d,t){$.ajax({url:r.allDaysRank.url(e,n),method:r.allDaysRank.method,success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),d&&d(e.message),o(e.code)):s&&s(e)},error:function(e){d&&d(e)},complete:function(e){t&&t()}})},window.API.getAllRecordsRank=function(e,n,s,d,t){$.ajax({url:r.allRecordsRank.url(e,n),method:r.allRecordsRank.method,success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),d&&d(e.message),o(e.code)):s&&s(e)},error:function(e){d&&d(e)},complete:function(e){t&&t()}})},window.API.getSign=function(e,n,s){$.ajax({url:r.sign.url(),method:r.sign.method,success:function(r){"SUCCESS"!=r.code?(r=JSON.parse(r),n&&n(r.message),o(r.code)):e&&e(r)},error:function(e){n&&n(e)},complete:function(e){s&&s()}})},window.API.getClass=function(e,n,s,d){$.ajax({url:r.getClass.url(),method:r.getClass.method,headers:r.getClass.headers(e),success:function(e){"SUCCESS"!=e.code?(e=JSON.parse(e),s&&s(e.message),o(e.code)):n&&n(e)},error:function(e){s&&s(e)},complete:function(e){d&&d()}})}}();