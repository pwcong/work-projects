{"version":3,"sources":["record.js"],"names":["$","document","ready","window","localStorage","sessionId","API","getUserInfo","data","code","result","attr","avater","removeClass","html","nickname","addClass","gender","record","insistDay","err","calendarWidth","innerWidth","calendarHeight","now","Date","getMonthRecords","getFullYear","getMonth","initData","forEach","item","index","push","date","currentDay","value","calendar","width","height","format","onSelected","view","weui","alert","className","viewChange","y","m","changeData","subItem","subIndex","getDate","each","idx","el","find","length","dotEl","createElement","append","click","e"],"mappings":"AACAA,EAAEC,UAAUC,MAAM,WAETC,OAAOC,aAAaC,WAIzBC,IAAIC,YACAJ,OAAOC,aAAaC,UACpB,SAAUG,GAEW,WAAbA,EAAKC,MAAsBD,EAAKE,SAIpCV,EAAE,WAAWW,KAAK,MAAOH,EAAKE,OAAOE,QAAU,mBAC/CZ,EAAE,WAAWa,YAAY,QACzBb,EAAE,SAASc,KAAKN,EAAKE,OAAOK,UAC5Bf,EAAE,QAAQgB,SAA+B,GAAtBR,EAAKE,OAAOO,OAAc,YAAqC,GAAtBT,EAAKE,OAAOO,OAAc,cAAgB,IACtGjB,EAAE,iBAAiBc,KAAKN,EAAKE,OAAOQ,QACpClB,EAAE,aAAac,KAAKN,EAAKE,OAAOS,aAEpC,SAAUC,KAGV,SAAUZ,QA+ClBR,EAAEC,UAAUC,MAAM,WAEd,GAAKC,OAAOC,aAAaC,UAAzB,CAIA,IAAIgB,EAAgBrB,EAAE,gBAAgBsB,aAClCC,EAAiC,IAAhBF,EAEjBG,EAAM,IAAIC,KACdnB,IAAIoB,gBACAvB,OAAOC,aAAaC,UACpBmB,EAAIG,cACJH,EAAII,WAAa,EACjB,SAAUpB,GAEN,IAAIqB,KAEa,WAAbrB,EAAKC,MAAqBD,EAAKE,QAE/BF,EAAKE,OAAOoB,QAAQ,SAAUC,EAAMC,GAEhCH,EAASI,MACLC,KAAMH,EAAKI,WACXC,MAAOL,EAAKb,WAOxBlB,EAAE,aAAaqC,UACXC,MAAOjB,EACPkB,OAAQhB,EACRiB,OAAQ,aACRhC,KAAMqB,EAENY,WAAY,SAAUC,EAAMR,EAAM1B,GACzBA,GAILmC,KAAKC,MAAMpC,EAAO,MACdqC,UAAW,YAInBC,WAAY,SAAUJ,EAAMK,EAAGC,GAEf,QAARN,GAAmBK,GAAMC,GAI7B1C,IAAIoB,gBACAvB,OAAOC,aAAaC,UACpB0C,EACAC,EACA,SAAUxC,GAEN,IAAIyC,KAEa,WAAbzC,EAAKC,MAAqBD,EAAKE,QAE/BF,EAAKE,OAAOoB,QAAQ,SAAUoB,EAASC,GACnCF,EAAW,IAAIxB,KAAKyB,EAAQf,YAAYiB,WAAaF,EAAQhC,SAKrElB,EAAE,8CAA8CqD,KAAK,SAAUC,EAAKC,GAEhE,GAAKN,EAAWK,EAAI,MAIjBtD,EAAEuD,GAAIC,KAAK,SAASC,OAAS,GAAhC,CAIA,IAAIC,EAAQzD,SAAS0D,cAAc,KACnCD,EAAMb,UAAY,MAElB7C,EAAEuD,GAAIK,OAAOF,GACb1D,EAAEuD,GAAIM,MAAM,SAASC,GAEjBnB,KAAKC,MAAMK,EAAWK,EAAI,GAAK,MAC3BT,UAAW,iBAQ3B,SAAUzB,KACV,SAAUZ,UAQ1B,SAAUY,KAGV,SAAUZ","file":"record.js","sourcesContent":["// 初始化信息\r\n$(document).ready(function () {\r\n\r\n    if (!window.localStorage.sessionId) {\r\n        return;\r\n    }\r\n\r\n    API.getUserInfo(\r\n        window.localStorage.sessionId,\r\n        function (data) {\r\n\r\n            if (data.code != 'SUCCESS' || !data.result) {\r\n                return;\r\n            }\r\n\r\n            $('#avatar').attr('src', data.result.avater || 'imgs/avatar.png');\r\n            $('#avatar').removeClass('hide');\r\n            $('#name').html(data.result.nickname);\r\n            $('#sex').addClass(data.result.gender == 1 ? 'icon-male' : (data.result.gender == 2 ? 'icon-female' : ''));\r\n            $('#practiceTime').html(data.result.record);\r\n            $('#duration').html(data.result.insistDay);\r\n        },\r\n        function (err) {\r\n\r\n        },\r\n        function (data) {\r\n\r\n        }\r\n    );\r\n\r\n\r\n});\r\n\r\n// 校验计时器状态\r\n// $(document).ready(function () {\r\n\r\n//     if (window.localStorage.sessionId && window.localStorage.timerFlag == 'true') {\r\n\r\n//         var hours = parseInt(window.localStorage.hours || 0);\r\n//         var minutes = parseInt(window.localStorage.minutes || 0);\r\n//         var seconds = parseInt(window.localStorage.seconds || 0);\r\n\r\n//         setInterval(function () {\r\n\r\n//             seconds++;\r\n\r\n//             if (seconds >= 60) {\r\n//                 seconds = 0;\r\n//                 minutes++;\r\n//             }\r\n\r\n//             if (minutes >= 60) {\r\n//                 minutes = 0;\r\n//                 hours++;\r\n//             }\r\n\r\n//             if (hours >= 24) {\r\n//                 hours = 0;\r\n//             }\r\n\r\n//             window.localStorage.hours = hours;\r\n//             window.localStorage.minutes = minutes;\r\n//             window.localStorage.seconds = seconds;\r\n\r\n//         }, 1000);\r\n\r\n//     }\r\n\r\n\r\n// });\r\n\r\n\r\n$(document).ready(function () {\r\n\r\n    if (!window.localStorage.sessionId) {\r\n        return;\r\n    }\r\n\r\n    var calendarWidth = $('.my-calendar').innerWidth();\r\n    var calendarHeight = calendarWidth * 0.87;\r\n\r\n    var now = new Date();\r\n    API.getMonthRecords(\r\n        window.localStorage.sessionId,\r\n        now.getFullYear(),\r\n        now.getMonth() + 1,\r\n        function (data) {\r\n\r\n            var initData = [];\r\n\r\n            if (data.code == 'SUCCESS' && data.result) {\r\n\r\n                data.result.forEach(function (item, index) {\r\n\r\n                    initData.push({\r\n                        date: item.currentDay,\r\n                        value: item.record\r\n                    });\r\n\r\n                });\r\n\r\n            }\r\n\r\n            $('#calendar').calendar({\r\n                width: calendarWidth,\r\n                height: calendarHeight,\r\n                format: 'yyyy-mm-dd',\r\n                data: initData,\r\n                // data: [],\r\n                onSelected: function (view, date, data) {\r\n                    if (!data) {\r\n                        return;\r\n                    }\r\n\r\n                    weui.alert(data + '分钟', {\r\n                        className: 'dialog'\r\n                    });\r\n\r\n                },\r\n                viewChange: function (view, y, m) {\r\n\r\n                    if (view != 'date' || !y || !m) {\r\n                        return;\r\n                    }\r\n\r\n                    API.getMonthRecords(\r\n                        window.localStorage.sessionId,\r\n                        y,\r\n                        m,\r\n                        function (data) {\r\n\r\n                            var changeData = {};\r\n\r\n                            if (data.code == 'SUCCESS' && data.result) {\r\n\r\n                                data.result.forEach(function (subItem, subIndex) {\r\n                                    changeData[new Date(subItem.currentDay).getDate()] = subItem.record;\r\n                                });\r\n\r\n                            }\r\n\r\n                            $('.date-items > li:nth-child(2) li:not(.old)').each(function (idx, el) {\r\n\r\n                                if (!changeData[idx+1]) {\r\n                                    return;\r\n                                }\r\n\r\n                                if($(el).find('i.dot').length > 0){\r\n                                    return;\r\n                                }\r\n\r\n                                var dotEl = document.createElement('i');\r\n                                dotEl.className = 'dot';\r\n\r\n                                $(el).append(dotEl);\r\n                                $(el).click(function(e){\r\n\r\n                                    weui.alert(changeData[idx+1] + '分钟', {\r\n                                        className: 'dialog'\r\n                                    });\r\n\r\n                                });\r\n\r\n                            });\r\n\r\n                        },\r\n                        function (err) {},\r\n                        function (data) {}\r\n\r\n                    );\r\n\r\n                }\r\n            });\r\n\r\n        },\r\n        function (err) {\r\n\r\n        },\r\n        function (data) {\r\n\r\n\r\n        }\r\n\r\n    );\r\n\r\n\r\n\r\n\r\n\r\n});"]}