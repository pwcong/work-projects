function RankingItem(e,n,a,t,i){this.ranking=e,this.media=1==e?"icon-gold":2==e?"icon-silver":3==e?"icon-copper":"icon-medal",this.avatar=n||"imgs/avatar.png",this.name=a||"-",this.sex=2==t?"icon-female":1==t?"icon-male":"",this.score=i||0}function loadRecordsRank(e,n,a,t){API.getAllRecordsRank(e,PAGE_SIZE,function(e){n&&n(e),"SUCCESS"==e.code&&e.result&&e.result.list&&(e.result.list.forEach(function(e,n){var a=new RankingItem(n+pageOffset_1+1,e.avater,e.nickname,e.gender,e.record);$("#timeRanking .tips").before(a.makeHTML())}),pageOffset_1+=e.result.list.length)},function(e){a&&a(e)},function(e){t&&t()})}function loadDaysRecords(e,n,a,t){API.getAllDaysRank(e,PAGE_SIZE,function(e){n&&n(e),"SUCCESS"==e.code&&e.result&&e.result.list&&(e.result.list.forEach(function(e,n){var a=new RankingItem(n+pageOffset_2+1,e.avater,e.nickname,e.gender,e.insistDay);$("#dayRanking .tips").before(a.makeHTML())}),pageOffset_2+=e.result.list.length)},function(e){a&&a(e)},function(e){t&&t()})}RankingItem.prototype.makeHTML=function(){var e=document.createElement("div");return e.className="item",e.innerHTML='        <div class="left">            <span class="medal icon '+this.media+'">'+(this.ranking>3?this.ranking:"")+'</span>            <img class="avatar" src="'+this.avatar+'" alt="avatar">            <span class="name">'+this.name+'</span>            <span class="sex icon '+this.sex+'"></span>        </div>        <div class="right">'+this.score+"</div>",e};var PAGE_SIZE=10,pageNo_1=1,pageOffset_1=0,hasMore_1=!1,pageNo_2=1,pageOffset_2=0,hasMore_2=!1;$(document).ready(function(){window.localStorage.sessionId&&(loadRecordsRank(pageNo_1,function(e){"SUCCESS"!=!e.code&&e.result&&(console.log(e),e.result.totalPage>pageNo_1?(pageNo_1++,hasMore_1=!0,$("#timeRanking .tips").html("加载更多")):(hasMore_1=!1,$("#timeRanking .tips").html("没有了~")))},function(e){},function(){}),loadDaysRecords(pageNo_2,function(e){"SUCCESS"!=!e.code&&e.result&&(e.result.totalPage>pageNo_2?(pageNo_2++,hasMore_2=!0,$("#dayRanking .tips").html("加载更多")):(hasMore_2=!1,$("#dayRanking .tips").html("没有了~")))},function(e){},function(){}),$("#timeRanking .tips").click(function(e){hasMore_1&&($("#timeRanking .tips").html("加载中"),loadRecordsRank(pageNo_1,function(e){"SUCCESS"!=!e.code&&e.result&&(e.result.totalPage>pageNo_1?(pageNo_1++,hasMore_1=!0,$("#timeRanking .tips").html("加载更多")):(hasMore_1=!1,$("#timeRanking .tips").html("没有了~")))},function(e){},function(){}))}),$("#dayRanking .tips").click(function(e){hasMore_2&&($("#dayRanking .tips").html("加载中"),loadDaysRecords(pageNo_2,function(e){"SUCCESS"!=!e.code&&e.result&&(e.result.totalPage>pageNo_2?(pageNo_2++,hasMore_2=!0,$("#dayRanking .tips").html("加载更多")):(hasMore_2=!1,$("#dayRanking .tips").html("没有了~")))},function(e){},function(){}))}),API.getUserInfo(window.localStorage.sessionId,function(e){if("SUCCESS"==e.code&&e.result){$("#avatar").attr("src",e.result.avater||"imgs/avatar.png"),$("#avatar").show(),$("#name").html(e.result.nickname),$("#sex").addClass(1==e.result.gender?"icon-male":2==e.result.gender?"icon-female":""),$("#practiceTime").html(e.result.record),$("#duration").html(e.result.insistDay);var n=e.result;API.getSign(function(e){if("SUCCESS"!=!e.code&&e.result){var a=e.result;wx.config({debug:!1,appId:a.appId,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline"]}),wx.onMenuShareTimeline({title:"晓雯音乐广州市桥分校百日练琴第三季活动",desc:n.nickname+"小朋友在晓雯音乐百日练琴计划中坚持了"+n.insistDay+"天，累计练习了"+n.record+"分钟",link:"http://www.ppfix.cn/activity/piano_rank/share.html?n="+n.nickname+"&a="+n.avater+"&s="+n.gender+"&ar="+n.record+"&i="+n.insistDay,imgUrl:n.avater,success:function(e){},cancel:function(e){}}),wx.onMenuShareAppMessage({title:"晓雯音乐广州市桥分校百日练琴第三季活动",desc:n.nickname+"小朋友在晓雯音乐百日练琴计划中坚持了"+n.insistDay+"天，累计练习了"+n.record+"分钟",link:"http://www.ppfix.cn/activity/piano_rank/share.html?n="+n.nickname+"&a="+n.avater+"&s="+n.gender+"&ar="+n.record+"&i="+n.insistDay,imgUrl:n.avater,success:function(e){},cancel:function(e){}})}},function(e){console.log(e)},function(e){})}},function(e){},function(e){}))}),$(document).ready(function(){$("#showTimeRanking").click(function(){$(this).addClass("active"),$("#showDayRanking").removeClass("active"),$("#timeRanking").removeClass("hide"),$("#dayRanking").addClass("hide")}),$("#showDayRanking").click(function(){$(this).addClass("active"),$("#showTimeRanking").removeClass("active"),$("#dayRanking").removeClass("hide"),$("#timeRanking").addClass("hide")})});
//# sourceMappingURL=ranking.js.map
