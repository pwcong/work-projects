{"version":3,"sources":["global.js"],"names":["MyTimer","onTicker","onStart","onStop","onRestart","this","timer","initSessionId","sessionId","utils","getUrlParam","window","localStorage","checkSessionId","prototype","start","startTime","ctx","Date","parse","clearInterval","setInterval","stop","restart","$","length","location","href"],"mappings":"CACA,WAEI,SAASA,EAAQC,EAAUC,EAASC,EAAQC,GAExCC,KAAKC,MAAQ,KAGbD,KAAKJ,SAAWA,GAAY,aAC5BI,KAAKH,QAAUA,GAAW,aAC1BG,KAAKF,OAASA,GAAU,aACxBE,KAAKD,UAAYA,GAAa,aAgDlC,SAASG,IACL,IAAIC,EAAYC,MAAMC,YAAY,aAE9BF,IACAG,OAAOC,aAAaJ,UAAYA,GAKxC,SAASK,IACL,QAAOF,OAAOC,aAAaJ,UArD/BR,EAAQc,UAAUC,MAAQ,SAAUC,GAEhC,IAAIC,EAAMZ,KACVY,EAAID,UAAYA,GAAaE,KAAKC,MAAM,IAAID,MAExCD,EAAIX,QACJc,cAAcH,EAAIX,OAClBW,EAAIX,MAAQ,MAGhBW,EAAIX,MAAQe,YAAY,WAEpBJ,EAAIhB,SAASgB,EAAID,YAElB,KAEHC,EAAIf,QAAQG,KAAKW,YAIrBhB,EAAQc,UAAUQ,KAAO,WAGjBjB,KAAKC,QACLc,cAAcf,KAAKC,OACnBD,KAAKC,MAAQ,MAGjBD,KAAKF,OAAOE,KAAKW,YAGrBhB,EAAQc,UAAUS,QAAU,WAExBlB,KAAKW,UAAYE,KAAKC,MAAM,IAAID,MAEhCb,KAAKD,UAAUC,KAAKW,YAuBpBT,IAEKM,IAmBMW,EAAE,uBAAuBC,OAhBhCd,OAAOe,SAASC,KAAO,qDAwD/BhB,OAAOX,QAAUA,EAtIrB","file":"global.js","sourcesContent":[";\r\n(function () {\r\n\r\n    function MyTimer(onTicker, onStart, onStop, onRestart) {\r\n\r\n        this.timer = null;\r\n\r\n\r\n        this.onTicker = onTicker || function () {};\r\n        this.onStart = onStart || function () {};\r\n        this.onStop = onStop || function () {};\r\n        this.onRestart = onRestart || function () {};\r\n\r\n    }\r\n\r\n\r\n    MyTimer.prototype.start = function (startTime) {\r\n\r\n        var ctx = this;\r\n        ctx.startTime = startTime || Date.parse(new Date());\r\n\r\n        if (ctx.timer) {\r\n            clearInterval(ctx.timer);\r\n            ctx.timer = null;\r\n        }\r\n\r\n        ctx.timer = setInterval(function () {\r\n\r\n            ctx.onTicker(ctx.startTime);\r\n\r\n        }, 1000);\r\n\r\n        ctx.onStart(this.startTime);\r\n\r\n    }\r\n\r\n    MyTimer.prototype.stop = function () {\r\n\r\n\r\n        if (this.timer) {\r\n            clearInterval(this.timer);\r\n            this.timer = null;\r\n        }\r\n\r\n        this.onStop(this.startTime);\r\n    }\r\n\r\n    MyTimer.prototype.restart = function () {\r\n\r\n        this.startTime = Date.parse(new Date());\r\n\r\n        this.onRestart(this.startTime);\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    // 初始化sessionId\r\n    function initSessionId() {\r\n        var sessionId = utils.getUrlParam('sessionId');\r\n\r\n        if (sessionId) {\r\n            window.localStorage.sessionId = sessionId;\r\n        }\r\n    }\r\n\r\n    // 校验sessionId\r\n    function checkSessionId() {\r\n        return window.localStorage.sessionId ? true : false;\r\n    }\r\n\r\n    function init() {\r\n\r\n        initSessionId();\r\n\r\n        if (!checkSessionId()) {\r\n\r\n            // window.location.href = 'http://localhost:3000/index.html';\r\n            window.location.href = 'http://www.ppfix.cn/activity/piano_rank/index.html';\r\n\r\n            // 调用授权接口获取sessionId\r\n            // API.getSessionId(\r\n            //     // 'http://www.ppfix.cn/activity/piano_rank/enter.html',\r\n            //     window.location.href,\r\n            //     function (data) {\r\n            //         window.location.href = data;\r\n            //     },\r\n            //     function (err) {\r\n            //         console.log(err);\r\n            //     },\r\n            //     function (data) {\r\n\r\n            //     }\r\n            // );\r\n        } else if ($('meta[js-sdk=\"true\"]').length > 0) {\r\n\r\n            // API.getSign(\r\n            //     function (data) {\r\n\r\n            //         if (!data.code == 'SUCCESS' || !data.result) {\r\n            //             return;\r\n            //         }\r\n\r\n            //         var result = data.result;\r\n\r\n            //         wx.config({\r\n            //             debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n            //             appId: result.appId, // 必填，公众号的唯一标识\r\n            //             timestamp: result.timestamp, // 必填，生成签名的时间戳\r\n            //             nonceStr: result.nonceStr, // 必填，生成签名的随机串\r\n            //             signature: result.signature, // 必填，签名，见附录1\r\n            //             jsApiList: [\r\n            //                 'onMenuShareAppMessage',\r\n            //                 'onMenuShareTimeline',\r\n            //                 // 'onMenuShareQQ',\r\n            //                 // 'onMenuShareWeibo',\r\n            //                 // 'onMenuShareQZone'\r\n            //             ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\r\n            //         });\r\n            //     },\r\n            //     function (err) {\r\n            //         console.log(err);\r\n            //     },\r\n            //     function (data) {\r\n\r\n            //     }\r\n            // );\r\n        }\r\n\r\n\r\n    }\r\n\r\n    init();\r\n\r\n    window.MyTimer = MyTimer;\r\n\r\n\r\n})();"]}