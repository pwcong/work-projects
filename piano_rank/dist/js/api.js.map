{"version":3,"sources":["api.js"],"names":["API_BASE","API","auth","url","targetUrl","method","sign","window","location","href","userInfo","headers","sessionId","modifyUserInfo","nickname","gender","age","grade","monthRecords","year","month","uploadRecord","record","beginTime","endTime","dayRecords","allRecords","allRecordsRank","pageNo","pageSize","allDaysRank","getClass","getSessionId","onSuccess","onError","onComplete","$","ajax","success","data","error","err","complete","getUserInfo","startTime","sex","getAllRecords","getDayRecords","getMonthRecords","getAllDaysRank","getAllRecordsRank","getSign"],"mappings":"CACA,WAEI,IAAIA,EAAW,iCAEXC,GAEAC,MACIC,IAAK,SAAUC,GACX,OAAOJ,EAAW,+BAAiCI,GAEvDC,OAAQ,OAEZC,MACIH,IAAK,WACD,OAAOH,EAAW,yBAA2BO,OAAOC,SAASC,MAEjEJ,OAAQ,OAEZK,UACIP,IAAK,WACD,OAAOH,EAAW,kBAEtBK,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBC,gBACIV,IAAK,SAAUW,EAAUC,EAAQC,EAAKC,GAOlC,OALAH,EAAWA,GAAY,GACvBC,EAASA,GAAU,GACnBC,EAAMA,GAAO,EACbC,EAAQA,GAAS,GAEVjB,EAAW,6BAA+Bc,EAAW,WAAaC,EAAS,QAAUC,EAAM,YAAcC,GAEpHZ,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBM,cACIf,IAAK,SAAUgB,EAAMC,GAKjB,OAHAD,EAAOA,GAAQ,GACfC,EAAQA,GAAS,GAEVpB,EAAW,+BAAiCmB,EAAO,UAAYC,GAE1Ef,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBS,cACIlB,IAAK,SAAUmB,EAAQC,EAAWC,GAO9B,OALAF,EAASA,GAAU,EACnBC,EAAYA,GAAa,GACzBC,EAAUA,GAAW,GAGdxB,EAAW,kCAAoCsB,GAE1DjB,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBa,YACItB,IAAK,WACD,OAAOH,EAAW,wBAEtBK,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBc,YACIvB,IAAK,SAAUgB,GAIX,OAFAA,EAAOA,GAAQ,GAERnB,EAAW,6BAA+BmB,GAErDd,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBe,gBACIxB,IAAK,SAAUyB,EAAQC,GAKnB,OAHAD,EAASA,GAAU,EACnBC,EAAWA,GAAY,IAEhB7B,EAAW,kCAAoC4B,EAAS,aAAeC,GAElFxB,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBkB,aACI3B,IAAK,SAAUyB,EAAQC,GAKnB,OAHAD,EAASA,GAAU,EACnBC,EAAWA,GAAY,IAEhB7B,EAAW,+BAAiC4B,EAAS,aAAeC,GAE/ExB,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,KAIvBmB,UACI5B,IAAK,SAAUyB,EAAQC,GAKnB,OAHAD,EAASA,GAAU,EACnBC,EAAWA,GAAY,IAEhB7B,EAAW,6BAA+B4B,EAAS,aAAeC,GAE7ExB,OAAQ,MACRM,QAAS,SAAUC,GACf,OACIA,UAAWA,MAuOtBL,OAAON,MACRM,OAAON,QAGXM,OAAON,IAAI+B,aAnOX,SAAsB7B,EAAK8B,EAAWC,EAASC,GAE3CC,EAAEC,MACElC,IAAKF,EAAIC,KAAKC,IAAIA,GAClBE,OAAQJ,EAAIC,KAAKG,OACjBiC,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAwN1B5B,OAAON,IAAI0C,YAlMX,SAAqB/B,EAAWqB,EAAWC,EAASC,GAEhDC,EAAEC,MAEElC,IAAKF,EAAIS,SAASP,MAClBE,OAAQJ,EAAIS,SAASL,OACrBM,QAASV,EAAIS,SAASC,QAAQC,GAC9B0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAqL1B5B,OAAON,IAAIoB,aA9KX,SAAsBT,EAAWU,EAAQsB,EAAWpB,EAASS,EAAWC,EAASC,GAE7EC,EAAEC,MACElC,IAAKF,EAAIoB,aAAalB,IAAImB,EAAQsB,EAAWpB,GAC7CnB,OAAQJ,EAAIoB,aAAahB,OACzBM,QAASV,EAAIoB,aAAaV,QAAQC,GAClC0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAkK1B5B,OAAON,IAAIY,eA3JX,SAAwBD,EAAWE,EAAU+B,EAAK7B,EAAKC,EAAOgB,EAAWC,EAASC,GAE9EC,EAAEC,MAEElC,IAAKF,EAAIY,eAAeV,IAAIW,EAAU+B,EAAK7B,EAAKC,GAChDZ,OAAQJ,EAAIY,eAAeR,OAC3BM,QAASV,EAAIY,eAAeF,QAAQC,GACpC0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QA8I1B5B,OAAON,IAAI6C,cAvIX,SAAuBlC,EAAWO,EAAMc,EAAWC,EAASC,GACxDC,EAAEC,MAEElC,IAAKF,EAAIyB,WAAWvB,IAAIgB,GACxBd,OAAQJ,EAAIyB,WAAWrB,OACvBM,QAASV,EAAIyB,WAAWf,QAAQC,GAChC0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QA2H1B5B,OAAON,IAAI8C,cApHX,SAAuBnC,EAAWqB,EAAWC,EAASC,GAElDC,EAAEC,MAEElC,IAAKF,EAAIwB,WAAWtB,MACpBE,OAAQJ,EAAIwB,WAAWpB,OACvBM,QAASV,EAAIwB,WAAWd,QAAQC,GAChC0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAuG1B5B,OAAON,IAAI+C,gBA/FX,SAAyBpC,EAAWO,EAAMC,EAAOa,EAAWC,EAASC,GAEjEC,EAAEC,MAEElC,IAAKF,EAAIiB,aAAaf,IAAIgB,EAAMC,GAChCf,OAAQJ,EAAIiB,aAAab,OACzBM,QAASV,EAAIiB,aAAaP,QAAQC,GAClC0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAkF1B5B,OAAON,IAAIgD,eA1EX,SAAwBrB,EAAQC,EAAUI,EAAWC,EAASC,GAE1DC,EAAEC,MAEElC,IAAKF,EAAI6B,YAAY3B,IAAIyB,EAAQC,GACjCxB,OAAQJ,EAAI6B,YAAYzB,OACxBiC,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QA8D1B5B,OAAON,IAAIiD,kBAtDX,SAA2BtB,EAAQC,EAAUI,EAAWC,EAASC,GAE7DC,EAAEC,MAEElC,IAAKF,EAAI0B,eAAexB,IAAIyB,EAAQC,GACpCxB,OAAQJ,EAAI0B,eAAetB,OAC3BiC,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QA0C1B5B,OAAON,IAAIkD,QA3NX,SAAiBlB,EAAWC,EAASC,GAEjCC,EAAEC,MACElC,IAAKF,EAAIK,KAAKH,MACdE,OAAQJ,EAAIK,KAAKD,OACjBiC,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAgN1B5B,OAAON,IAAI8B,SAnCX,SAAkBnB,EAAWqB,EAAWC,EAASC,GAE7CC,EAAEC,MAEElC,IAAKF,EAAI8B,SAAS5B,MAClBE,OAAQJ,EAAI8B,SAAS1B,OACrBM,QAASV,EAAI8B,SAASpB,QAAQC,GAC9B0B,QAAS,SAAUC,GACfN,GAAaA,EAAUM,IAE3BC,MAAO,SAAUC,GACbP,GAAWA,EAAQO,IAEvBC,SAAU,SAAUH,GAChBJ,GAAcA,QAhX9B","file":"api.js","sourcesContent":[";\r\n(function () {\r\n\r\n    var API_BASE = 'http://www.ppfix.cn/piano_rank';\r\n\r\n    var API = {\r\n\r\n        auth: {\r\n            url: function (targetUrl) {\r\n                return API_BASE + '/api/wx/authUrl?redirectUri=' + targetUrl;\r\n            },\r\n            method: 'GET'\r\n        },\r\n        sign: {\r\n            url: function () {\r\n                return API_BASE + '/api/wx/jsapiSign?url=' + window.location.href;\r\n            },\r\n            method: 'GET'\r\n        },\r\n        userInfo: {\r\n            url: function () {\r\n                return API_BASE + '/api/user/info';\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        modifyUserInfo: {\r\n            url: function (nickname, gender, age, grade) {\r\n\r\n                nickname = nickname || '';\r\n                gender = gender || '';\r\n                age = age || 0;\r\n                grade = grade || '';\r\n\r\n                return API_BASE + '/api/user/update?nickname=' + nickname + '&gender=' + gender + '&age=' + age + '&classId=' + grade;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        monthRecords: {\r\n            url: function (year, month) {\r\n\r\n                year = year || '';\r\n                month = month || '';\r\n\r\n                return API_BASE + '/api/user/record/month?year=' + year + '&month=' + month;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        uploadRecord: {\r\n            url: function (record, beginTime, endTime) {\r\n\r\n                record = record || 0;\r\n                beginTime = beginTime || '';\r\n                endTime = endTime || '';\r\n\r\n                // return API_BASE + '/api/user/record/upload?record=' + record + '&beginTime=' + beginTime + '&endTime=' + endTime;\r\n                return API_BASE + '/api/user/record/upload?record=' + record;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        dayRecords: {\r\n            url: function () {\r\n                return API_BASE + '/api/user/record/day';\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allRecords: {\r\n            url: function (year) {\r\n\r\n                year = year || '';\r\n\r\n                return API_BASE + '/api/user/record/all?year=' + year;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allRecordsRank: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/rank/orderByRecord?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allDaysRank: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/rank/orderByDay?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        getClass: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/user/getClass?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n\r\n    }\r\n\r\n\r\n    function getSessionId(url, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.auth.url(url),\r\n            method: API.auth.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n        });\r\n    }\r\n\r\n    function getSign(onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.sign.url(),\r\n            method: API.sign.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n        });\r\n    }\r\n\r\n    function getUserInfo(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.userInfo.url(),\r\n            method: API.userInfo.method,\r\n            headers: API.userInfo.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function uploadRecord(sessionId, record, startTime, endTime, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.uploadRecord.url(record, startTime, endTime),\r\n            method: API.uploadRecord.method,\r\n            headers: API.uploadRecord.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function modifyUserInfo(sessionId, nickname, sex, age, grade, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.modifyUserInfo.url(nickname, sex, age, grade),\r\n            method: API.modifyUserInfo.method,\r\n            headers: API.modifyUserInfo.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n    }\r\n\r\n    function getAllRecords(sessionId, year, onSuccess, onError, onComplete) {\r\n        $.ajax({\r\n\r\n            url: API.allRecords.url(year),\r\n            method: API.allRecords.method,\r\n            headers: API.allRecords.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n    }\r\n\r\n    function getDayRecords(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.dayRecords.url(),\r\n            method: API.dayRecords.method,\r\n            headers: API.dayRecords.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function getMonthRecords(sessionId, year, month, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.monthRecords.url(year, month),\r\n            method: API.monthRecords.method,\r\n            headers: API.monthRecords.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function getAllDaysRank(pageNo, pageSize, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.allDaysRank.url(pageNo, pageSize),\r\n            method: API.allDaysRank.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function getAllRecordsRank(pageNo, pageSize, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.allRecordsRank.url(pageNo, pageSize),\r\n            method: API.allRecordsRank.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n    \r\n    function getClass(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.getClass.url(),\r\n            method: API.getClass.method,\r\n            headers: API.getClass.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    if (!window.API) {\r\n        window.API = {};\r\n    }\r\n\r\n    window.API.getSessionId = getSessionId;\r\n    window.API.getUserInfo = getUserInfo;\r\n    window.API.uploadRecord = uploadRecord;\r\n    window.API.modifyUserInfo = modifyUserInfo;\r\n    window.API.getAllRecords = getAllRecords;\r\n    window.API.getDayRecords = getDayRecords;\r\n    window.API.getMonthRecords = getMonthRecords;\r\n    window.API.getAllDaysRank = getAllDaysRank;\r\n    window.API.getAllRecordsRank = getAllRecordsRank;\r\n    window.API.getSign = getSign;\r\n    window.API.getClass = getClass;\r\n\r\n\r\n})();"]}