{"version":3,"sources":["api.js"],"names":["API_BASE","API","auth","url","targetUrl","method","sign","window","location","href","userInfo","headers","sessionId","modifyUserInfo","nickname","gender","age","grade","uploadRecord","record","beginTime","endTime","dayRecords","allRecords","year","allRecordsRank","pageNo","pageSize","allDaysRank","getClass","getSessionId","onSuccess","onError","onComplete","$","ajax","success","data","error","err","complete","getUserInfo","startTime","sex","getAllRecords","getDayRecords","getAllDaysRank","getAllRecordsRank","getSign"],"mappings":"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","file":"api.js","sourcesContent":[";\r\n(function () {\r\n\r\n    var API_BASE = 'http://www.ppfix.cn/piano_rank';\r\n\r\n    var API = {\r\n\r\n        auth: {\r\n            url: function (targetUrl) {\r\n                return API_BASE + '/api/wx/authUrl?redirectUri=' + targetUrl;\r\n            },\r\n            method: 'GET'\r\n        },\r\n        sign: {\r\n            url: function () {\r\n                return API_BASE + '/api/wx/jsapiSign?url=' + window.location.href;\r\n            },\r\n            method: 'GET'\r\n        },\r\n        userInfo: {\r\n            url: function () {\r\n                return API_BASE + '/api/user/info';\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        modifyUserInfo: {\r\n            url: function (nickname, gender, age, grade) {\r\n\r\n                nickname = nickname || '';\r\n                gender = gender || '';\r\n                age = age || 0;\r\n                grade = grade || '';\r\n\r\n                return API_BASE + '/api/user/update?nickname=' + nickname + '&gender=' + gender + '&age=' + age + '&classId=' + grade;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        uploadRecord: {\r\n            url: function (record, beginTime, endTime) {\r\n\r\n                record = record || 0;\r\n                beginTime = beginTime || '';\r\n                endTime = endTime || '';\r\n\r\n                // return API_BASE + '/api/user/record/upload?record=' + record + '&beginTime=' + beginTime + '&endTime=' + endTime;\r\n                return API_BASE + '/api/user/record/upload?record=' + record;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        dayRecords: {\r\n            url: function () {\r\n                return API_BASE + '/api/user/record/day';\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allRecords: {\r\n            url: function (year) {\r\n\r\n                year = year || '';\r\n\r\n                return API_BASE + '/api/user/record/all?year=' + year;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allRecordsRank: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/rank/orderByRecord?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        allDaysRank: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/rank/orderByDay?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n        getClass: {\r\n            url: function (pageNo, pageSize) {\r\n\r\n                pageNo = pageNo || 1;\r\n                pageSize = pageSize || 100;\r\n\r\n                return API_BASE + '/api/user/getClass?pageNo=' + pageNo + '&pageSize=' + pageSize;\r\n            },\r\n            method: 'GET',\r\n            headers: function (sessionId) {\r\n                return {\r\n                    sessionId: sessionId\r\n                }\r\n            }\r\n        },\r\n\r\n    }\r\n\r\n\r\n    function getSessionId(url, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.auth.url(url),\r\n            method: API.auth.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n        });\r\n    }\r\n\r\n    function getSign(onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.sign.url(),\r\n            method: API.sign.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n        });\r\n    }\r\n\r\n    function getUserInfo(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.userInfo.url(),\r\n            method: API.userInfo.method,\r\n            headers: API.userInfo.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function uploadRecord(sessionId, record, startTime, endTime, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n            url: API.uploadRecord.url(record, startTime, endTime),\r\n            method: API.uploadRecord.method,\r\n            headers: API.uploadRecord.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function modifyUserInfo(sessionId, nickname, sex, age, grade, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.modifyUserInfo.url(nickname, sex, age, grade),\r\n            method: API.modifyUserInfo.method,\r\n            headers: API.modifyUserInfo.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n    }\r\n\r\n    function getAllRecords(sessionId, year, onSuccess, onError, onComplete) {\r\n        $.ajax({\r\n\r\n            url: API.allRecords.url(year),\r\n            method: API.allRecords.method,\r\n            headers: API.allRecords.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n    }\r\n\r\n    function getDayRecords(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.dayRecords.url(),\r\n            method: API.dayRecords.method,\r\n            headers: API.dayRecords.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function getAllDaysRank(onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.allDaysRank.url(),\r\n            method: API.allDaysRank.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function getAllRecordsRank(onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.allRecordsRank.url(),\r\n            method: API.allRecordsRank.method,\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n\r\n        });\r\n\r\n    }\r\n    \r\n    function getClass(sessionId, onSuccess, onError, onComplete) {\r\n\r\n        $.ajax({\r\n\r\n            url: API.getClass.url(),\r\n            method: API.getClass.method,\r\n            headers: API.getClass.headers(sessionId),\r\n            success: function (data) {\r\n                onSuccess && onSuccess(data);\r\n            },\r\n            error: function (err) {\r\n                onError && onError(err);\r\n            },\r\n            complete: function (data) {\r\n                onComplete && onComplete();\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    if (!window.API) {\r\n        window.API = {};\r\n    }\r\n\r\n    window.API.getSessionId = getSessionId;\r\n    window.API.getUserInfo = getUserInfo;\r\n    window.API.uploadRecord = uploadRecord;\r\n    window.API.modifyUserInfo = modifyUserInfo;\r\n    window.API.getAllRecords = getAllRecords;\r\n    window.API.getDayRecords = getDayRecords;\r\n    window.API.getAllDaysRank = getAllDaysRank;\r\n    window.API.getAllRecordsRank = getAllRecordsRank;\r\n    window.API.getSign = getSign;\r\n    window.API.getClass = getClass;\r\n\r\n\r\n})();"]}